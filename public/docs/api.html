<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>API Guide ‚Äî SMSaaS Documentation</title>
<link rel="stylesheet" href="docs.css">
</head>
<body>

<header class="topbar">
  <a href="index.html" class="topbar-logo">
    <div class="topbar-icon">üí¨</div>
    <span class="topbar-name">SMSaaS</span>
  </a>
  <span class="topbar-product">Documentation</span>
  <nav class="topbar-nav">
    <a href="index.html" class="topbar-link">Overview</a>
    <a href="brd.html" class="topbar-link">BRD</a>
    <a href="frd.html" class="topbar-link">FRD</a>
    <a href="api.html" class="topbar-link active">API Guide</a>
    <a href="../index.html" class="topbar-link">‚Üê API Console</a>
  </nav>
</header>

<div class="layout">
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-section-title">API Guide</div>
      <a href="#basics" class="sidebar-link active"><span class="dot"></span>Basics & Auth</a>
      <a href="#admin" class="sidebar-link"><span class="dot"></span>Admin ‚Äî Tenants</a>
      <a href="#contacts" class="sidebar-link"><span class="dot"></span>Contacts</a>
      <a href="#groups" class="sidebar-link"><span class="dot"></span>Groups</a>
      <a href="#campaigns" class="sidebar-link"><span class="dot"></span>Campaigns</a>
      <a href="#credits" class="sidebar-link"><span class="dot"></span>Credits</a>
      <a href="#webhooks" class="sidebar-link"><span class="dot"></span>Webhooks</a>
      <a href="#errors" class="sidebar-link"><span class="dot"></span>Error Reference</a>
      <a href="#examples" class="sidebar-link"><span class="dot"></span>Full Examples</a>
    </div>
    <div class="sidebar-divider"></div>
    <div class="sidebar-section">
      <div class="sidebar-section-title">Other Documents</div>
      <a href="index.html" class="sidebar-link"><span class="dot"></span>Product Overview</a>
      <a href="brd.html" class="sidebar-link"><span class="dot"></span>BRD</a>
      <a href="frd.html" class="sidebar-link"><span class="dot"></span>FRD</a>
    </div>
  </aside>

  <main class="main">
    <div class="content">

      <div class="breadcrumb">
        <a href="index.html">Docs</a>
        <span class="breadcrumb-sep">‚Ä∫</span>
        <span>API Guide</span>
      </div>

      <div class="page-header">
        <div class="page-eyebrow">üîå API Guide</div>
        <h1 class="page-title">API Reference</h1>
        <p class="page-subtitle">Complete reference for all SMSaaS API endpoints including authentication, request formats, response shapes, and error codes.</p>
        <div class="page-meta">
          <span class="meta-item"><strong>Base URL (prod)</strong> <code>https://your-app.railway.app/api/v1</code></span>
          <span class="meta-item"><strong>Base URL (dev)</strong> <code>http://localhost:3001/api/v1</code></span>
          <span class="meta-item"><strong>Format</strong> JSON</span>
        </div>
      </div>

      <!-- BASICS -->
      <h1 class="section-title section-anchor" id="basics">Basics & Authentication</h1>

      <h2 class="subsection">Request format</h2>
      <p>All requests must include <code>Content-Type: application/json</code> for POST/PUT/PATCH endpoints. All responses are JSON.</p>

      <h2 class="subsection">Authentication</h2>
      <p>There are two authentication mechanisms depending on the endpoint type:</p>

      <h3 class="sub-subsection">Tenant endpoints ‚Äî API Key</h3>
      <pre>Authorization: Bearer &lt;64_char_hex_api_key&gt;</pre>
      <p>Used for all <code>/contacts</code>, <code>/groups</code>, <code>/campaigns</code>, and <code>/credits</code> endpoints. The API key identifies and authenticates the tenant simultaneously.</p>

      <h3 class="sub-subsection">Admin endpoints ‚Äî Admin Secret</h3>
      <pre>x-admin-secret: &lt;your_admin_secret&gt;</pre>
      <p>Used for all <code>/admin/*</code> endpoints. Set via the <code>ADMIN_SECRET</code> environment variable on the server.</p>

      <div class="callout callout-warning">
        <span class="callout-icon">‚ö†Ô∏è</span>
        <div class="callout-body">
          <p class="callout-title">API key security</p>
          <p class="callout-text">API keys are shown only once ‚Äî when a tenant is created or when the key is rotated. Store them immediately and securely. Never expose them in client-side code or public repositories.</p>
        </div>
      </div>

      <h2 class="subsection">Health check</h2>
      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/health</span>
          <span class="endpoint-desc">No authentication required</span>
        </div>
        <div class="endpoint-body">
          <p>Returns server status and timestamp. Use this to verify the server is running before making other requests.</p>
          <pre>{
  <span class="key">"status"</span>: <span class="str">"ok"</span>,
  <span class="key">"ts"</span>: <span class="str">"2026-02-20T10:00:00.000Z"</span>
}</pre>
        </div>
      </div>

      <!-- ADMIN -->
      <h1 class="section-title section-anchor" id="admin">Admin ‚Äî Tenant Management</h1>
      <p>All admin endpoints require the <code>x-admin-secret</code> header.</p>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/admin/tenants</span>
          <span class="endpoint-desc">List all tenants</span>
        </div>
        <div class="endpoint-body">
          <p>Returns all tenants with contact and campaign counts. API keys are never included.</p>
          <pre>[{
  <span class="key">"id"</span>: <span class="str">"clx..."</span>,
  <span class="key">"name"</span>: <span class="str">"Reethi Cafe"</span>,
  <span class="key">"email"</span>: <span class="str">"admin@reethicafe.mv"</span>,
  <span class="key">"creditBalance"</span>: <span class="num">1000</span>,
  <span class="key">"isActive"</span>: <span class="kw">true</span>,
  <span class="key">"createdAt"</span>: <span class="str">"2026-02-01T..."</span>,
  <span class="key">"_count"</span>: { <span class="key">"contacts"</span>: <span class="num">450</span>, <span class="key">"campaigns"</span>: <span class="num">12</span> }
}]</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/admin/tenants</span>
          <span class="endpoint-desc">Create new tenant</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td>name</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>Business name</td></tr>
              <tr><td>email</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>Unique email address</td></tr>
              <tr><td>initialCredits</td><td>number</td><td><span class="badge badge-opt">no</span></td><td>Starting credit balance, default 0</td></tr>
            </tbody>
          </table>
          <pre><span class="comment">// Response ‚Äî apiKey shown ONLY this once</span>
{
  <span class="key">"id"</span>: <span class="str">"clx..."</span>,
  <span class="key">"name"</span>: <span class="str">"Reethi Cafe"</span>,
  <span class="key">"email"</span>: <span class="str">"admin@reethicafe.mv"</span>,
  <span class="key">"creditBalance"</span>: <span class="num">1000</span>,
  <span class="key">"apiKey"</span>: <span class="str">"a3f8c2...64chars"</span>
}</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/admin/tenants/:id/credits</span>
          <span class="endpoint-desc">Top up credits</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td>amount</td><td>integer</td><td><span class="badge badge-req">yes</span></td><td>Number of credits to add (min 1)</td></tr>
              <tr><td>reason</td><td>string</td><td><span class="badge badge-opt">no</span></td><td>Reason for top-up, default "Manual top-up"</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/admin/tenants/:id/rotate-key</span>
          <span class="endpoint-desc">Rotate API key</span>
        </div>
        <div class="endpoint-body">
          <p>Generates a new API key and invalidates the old one immediately. Returns the new key once.</p>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-put">PATCH</span>
          <span class="endpoint-path">/admin/tenants/:id/status</span>
          <span class="endpoint-desc">Toggle active status</span>
        </div>
        <div class="endpoint-body">
          <p>Toggles <code>isActive</code> between true and false. Disabled tenants get 401 on all API calls.</p>
        </div>
      </div>

      <!-- CONTACTS -->
      <h1 class="section-title section-anchor" id="contacts">Contacts</h1>
      <p>All endpoints require <code>Authorization: Bearer &lt;API_KEY&gt;</code>. All data is scoped to the authenticated tenant.</p>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/contacts</span>
          <span class="endpoint-desc">List contacts</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Query Param</th><th>Default</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td>search</td><td>‚Äî</td><td>Filter by name or phone (case-insensitive)</td></tr>
              <tr><td>page</td><td>1</td><td>Page number</td></tr>
              <tr><td>limit</td><td>50</td><td>Results per page (max 200)</td></tr>
            </tbody>
          </table>
          <pre>{
  <span class="key">"contacts"</span>: [{ <span class="key">"id"</span>: <span class="str">"..."</span>, <span class="key">"name"</span>: <span class="str">"Ahmed"</span>, <span class="key">"phone"</span>: <span class="str">"+9607123456"</span>, <span class="key">"optedOut"</span>: <span class="kw">false</span> }],
  <span class="key">"total"</span>: <span class="num">450</span>,
  <span class="key">"page"</span>: <span class="num">1</span>,
  <span class="key">"pages"</span>: <span class="num">9</span>
}</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/contacts</span>
          <span class="endpoint-desc">Create or update contact</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td>phone</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>Maldivian mobile number ‚Äî auto-normalised to +9607xxxxxxx</td></tr>
              <tr><td>name</td><td>string</td><td><span class="badge badge-opt">no</span></td><td>Display name</td></tr>
              <tr><td>notes</td><td>string</td><td><span class="badge badge-opt">no</span></td><td>Free-text notes</td></tr>
            </tbody>
          </table>
          <p>If a contact with the same phone already exists for this tenant, it is updated (upsert).</p>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/contacts/import</span>
          <span class="endpoint-desc">Bulk import from CSV</span>
        </div>
        <div class="endpoint-body">
          <p>Multipart form-data. Field name: <code>file</code>. Max file size: 5MB. CSV columns: <code>name</code>, <code>phone</code> (or <code>number</code>), <code>notes</code>.</p>
          <pre>{
  <span class="key">"imported"</span>: <span class="num">487</span>,
  <span class="key">"skipped"</span>: <span class="num">13</span>,
  <span class="key">"errors"</span>: [
    <span class="str">"Row {phone: '123'}: Invalid Maldivian phone number"</span>
  ]
}</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-put">PUT</span>
          <span class="endpoint-path">/contacts/:id</span>
          <span class="endpoint-desc">Update contact</span>
        </div>
        <div class="endpoint-body"><p>Partial update ‚Äî only include fields you want to change.</p></div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-delete">DELETE</span>
          <span class="endpoint-path">/contacts/:id</span>
          <span class="endpoint-desc">Delete contact</span>
        </div>
        <div class="endpoint-body"><p>Permanently deletes the contact and removes it from all groups. Historical message records are preserved.</p></div>
      </div>

      <!-- GROUPS -->
      <h1 class="section-title section-anchor" id="groups">Groups</h1>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/groups</span>
          <span class="endpoint-desc">List all groups</span>
        </div>
        <div class="endpoint-body">
          <pre>[{
  <span class="key">"id"</span>: <span class="str">"clx..."</span>,
  <span class="key">"name"</span>: <span class="str">"VIP Customers"</span>,
  <span class="key">"createdAt"</span>: <span class="str">"..."</span>,
  <span class="key">"_count"</span>: { <span class="key">"contacts"</span>: <span class="num">142</span> }
}]</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/groups</span>
          <span class="endpoint-desc">Create group</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Field</th><th>Type</th><th>Required</th></tr></thead>
            <tbody><tr><td>name</td><td>string</td><td><span class="badge badge-req">yes</span></td></tr></tbody>
          </table>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/groups/:id/contacts</span>
          <span class="endpoint-desc">List contacts in group</span>
        </div>
        <div class="endpoint-body"><p>Paginated. Supports <code>?page=</code> and <code>?limit=</code> query params.</p></div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/groups/:id/contacts</span>
          <span class="endpoint-desc">Add contacts to group</span>
        </div>
        <div class="endpoint-body">
          <pre><span class="comment">// Body</span>
{ <span class="key">"contactIds"</span>: [<span class="str">"clx1"</span>, <span class="str">"clx2"</span>, <span class="str">"clx3"</span>] }

<span class="comment">// Response</span>
{ <span class="key">"added"</span>: <span class="num">3</span> }</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-delete">DELETE</span>
          <span class="endpoint-path">/groups/:id/contacts</span>
          <span class="endpoint-desc">Remove contacts from group</span>
        </div>
        <div class="endpoint-body">
          <pre>{ <span class="key">"contactIds"</span>: [<span class="str">"clx1"</span>, <span class="str">"clx2"</span>] }</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-delete">DELETE</span>
          <span class="endpoint-path">/groups/:id</span>
          <span class="endpoint-desc">Delete group</span>
        </div>
        <div class="endpoint-body"><p>Deletes the group and removes all group memberships. Contacts themselves are not deleted.</p></div>
      </div>

      <!-- CAMPAIGNS -->
      <h1 class="section-title section-anchor" id="campaigns">Campaigns</h1>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/campaigns</span>
          <span class="endpoint-desc">List all campaigns</span>
        </div>
        <div class="endpoint-body"><p>Returns all campaigns ordered by most recent. Includes group name and all status counts.</p></div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/campaigns</span>
          <span class="endpoint-desc">Launch a campaign</span>
        </div>
        <div class="endpoint-body">
          <table class="doc-table">
            <thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td>name</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>Campaign label for your reference</td></tr>
              <tr><td>groupId</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>ID of the group to send to</td></tr>
              <tr><td>message</td><td>string</td><td><span class="badge badge-req">yes</span></td><td>SMS body, max 918 characters</td></tr>
            </tbody>
          </table>
          <pre><span class="comment">// Response ‚Äî returns immediately, does not wait for sends</span>
{
  <span class="key">"id"</span>: <span class="str">"clx..."</span>,
  <span class="key">"name"</span>: <span class="str">"Ramadan Promo"</span>,
  <span class="key">"status"</span>: <span class="str">"RUNNING"</span>,
  <span class="key">"totalMessages"</span>: <span class="num">500</span>,
  <span class="key">"creditsUsed"</span>: <span class="num">500</span>,
  <span class="key">"message"</span>: <span class="str">"500 messages queued"</span>
}

<span class="comment">// Error ‚Äî insufficient credits</span>
{
  <span class="key">"error"</span>: <span class="str">"Insufficient credits"</span>,
  <span class="key">"required"</span>: <span class="num">500</span>,
  <span class="key">"available"</span>: <span class="num">200</span>
}</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/campaigns/:id/progress</span>
          <span class="endpoint-desc">Live campaign progress ‚Äî poll every 2.5s</span>
        </div>
        <div class="endpoint-body">
          <pre>{
  <span class="key">"id"</span>: <span class="str">"clx..."</span>,
  <span class="key">"name"</span>: <span class="str">"Ramadan Promo"</span>,
  <span class="key">"status"</span>: <span class="str">"RUNNING"</span>,
  <span class="key">"totalMessages"</span>: <span class="num">500</span>,
  <span class="key">"sentCount"</span>: <span class="num">342</span>,
  <span class="key">"failedCount"</span>: <span class="num">3</span>,
  <span class="key">"pending"</span>: <span class="num">155</span>,
  <span class="key">"progressPercent"</span>: <span class="num">69</span>
}</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/campaigns/:id/cancel</span>
          <span class="endpoint-desc">Cancel running campaign</span>
        </div>
        <div class="endpoint-body">
          <p>Only RUNNING campaigns can be cancelled. Refunds credits for all unprocessed messages.</p>
          <pre>{ <span class="key">"success"</span>: <span class="kw">true</span>, <span class="key">"creditsRefunded"</span>: <span class="num">158</span> }</pre>
        </div>
      </div>

      <!-- CREDITS -->
      <h1 class="section-title section-anchor" id="credits">Credits</h1>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/credits</span>
          <span class="endpoint-desc">Get current balance</span>
        </div>
        <div class="endpoint-body">
          <pre>{ <span class="key">"balance"</span>: <span class="num">750</span>, <span class="key">"currency"</span>: <span class="str">"credits"</span> }</pre>
        </div>
      </div>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-get">GET</span>
          <span class="endpoint-path">/credits/ledger</span>
          <span class="endpoint-desc">Transaction history</span>
        </div>
        <div class="endpoint-body">
          <p>Paginated. Supports <code>?page=</code> and <code>?limit=</code>. Returns all credit transactions ‚Äî top-ups, campaign debits, and refunds.</p>
          <pre>{
  <span class="key">"entries"</span>: [{
    <span class="key">"id"</span>: <span class="str">"clx..."</span>,
    <span class="key">"amount"</span>: <span class="num">-500</span>,
    <span class="key">"type"</span>: <span class="str">"DEBIT"</span>,
    <span class="key">"reason"</span>: <span class="str">"Campaign: Ramadan Promo"</span>,
    <span class="key">"createdAt"</span>: <span class="str">"2026-02-20T..."</span>
  }],
  <span class="key">"total"</span>: <span class="num">24</span>, <span class="key">"page"</span>: <span class="num">1</span>, <span class="key">"pages"</span>: <span class="num">2</span>
}</pre>
        </div>
      </div>

      <!-- WEBHOOKS -->
      <h1 class="section-title section-anchor" id="webhooks">Webhooks</h1>

      <div class="endpoint">
        <div class="endpoint-header">
          <span class="badge badge-post">POST</span>
          <span class="endpoint-path">/webhooks/twilio</span>
          <span class="endpoint-desc">Twilio status callback ‚Äî internal use only</span>
        </div>
        <div class="endpoint-body">
          <p>Twilio calls this endpoint automatically when a message status changes. You set this URL in your Twilio Messaging Service settings. Do not call this manually.</p>
          <p>Request format: <code>application/x-www-form-urlencoded</code> (not JSON). Validated with Twilio request signature in production.</p>
          <table class="doc-table">
            <thead><tr><th>Twilio Field</th><th>Mapped To</th></tr></thead>
            <tbody>
              <tr><td>MessageSid</td><td>Looked up in Message.twilioSid to find the record</td></tr>
              <tr><td>MessageStatus: sent</td><td>Message.status ‚Üí SENT</td></tr>
              <tr><td>MessageStatus: delivered</td><td>Message.status ‚Üí DELIVERED</td></tr>
              <tr><td>MessageStatus: failed</td><td>Message.status ‚Üí FAILED</td></tr>
              <tr><td>MessageStatus: undelivered</td><td>Message.status ‚Üí UNDELIVERED</td></tr>
              <tr><td>ErrorCode</td><td>Message.errorCode</td></tr>
              <tr><td>ErrorMessage</td><td>Message.errorMessage</td></tr>
            </tbody>
          </table>
          <div class="callout callout-info">
            <span class="callout-icon">üìå</span>
            <div class="callout-body">
              <p class="callout-title">Configure in Twilio</p>
              <p class="callout-text">In Twilio Console ‚Üí Messaging ‚Üí Services ‚Üí your service ‚Üí set Status Callback URL to: <code>https://your-app.railway.app/api/v1/webhooks/twilio</code></p>
            </div>
          </div>
        </div>
      </div>

      <!-- ERRORS -->
      <h1 class="section-title section-anchor" id="errors">Error Reference</h1>
      <table class="doc-table">
        <thead><tr><th>HTTP Status</th><th>Meaning</th><th>Common Cause</th></tr></thead>
        <tbody>
          <tr><td>400 Bad Request</td><td>Validation failed</td><td>Invalid phone number, missing required field, empty group</td></tr>
          <tr><td>401 Unauthorized</td><td>Authentication failed</td><td>Missing/invalid API key, missing admin secret, inactive tenant</td></tr>
          <tr><td>402 Payment Required</td><td>Insufficient credits</td><td>Campaign requires more credits than tenant has</td></tr>
          <tr><td>403 Forbidden</td><td>Access denied</td><td>Invalid Twilio webhook signature</td></tr>
          <tr><td>404 Not Found</td><td>Resource not found</td><td>Wrong ID, or resource belongs to different tenant</td></tr>
          <tr><td>429 Too Many Requests</td><td>Rate limit exceeded</td><td>More than 200 requests/minute from same IP</td></tr>
          <tr><td>500 Internal Server Error</td><td>Server error</td><td>Database or queue connection issue ‚Äî check server logs</td></tr>
        </tbody>
      </table>

      <h2 class="subsection">Error response shape</h2>
      <pre>{
  <span class="key">"error"</span>: <span class="str">"Human readable error message"</span>,

  <span class="comment">// Validation errors include field-level detail:</span>
  <span class="key">"error"</span>: {
    <span class="key">"fieldErrors"</span>: {
      <span class="key">"phone"</span>: [<span class="str">"Invalid Maldivian phone number"</span>],
      <span class="key">"name"</span>: [<span class="str">"Required"</span>]
    }
  },

  <span class="comment">// Credit error includes balance detail:</span>
  <span class="key">"error"</span>: <span class="str">"Insufficient credits"</span>,
  <span class="key">"required"</span>: <span class="num">500</span>,
  <span class="key">"available"</span>: <span class="num">200</span>
}</pre>

      <!-- FULL EXAMPLES -->
      <h1 class="section-title section-anchor" id="examples">Full End-to-End Example</h1>
      <p>Complete workflow from creating a tenant to running a campaign using curl.</p>

      <h3 class="sub-subsection">Step 1 ‚Äî Create tenant (admin)</h3>
      <pre>curl -X POST http://localhost:3001/api/v1/admin/tenants \
  -H <span class="str">"Content-Type: application/json"</span> \
  -H <span class="str">"x-admin-secret: your_admin_secret"</span> \
  -d <span class="str">'{"name":"Reethi Cafe","email":"sms@reethicafe.mv","initialCredits":2000}'</span>

<span class="comment"># Save the apiKey from the response!</span></pre>

      <h3 class="sub-subsection">Step 2 ‚Äî Import contacts</h3>
      <pre>curl -X POST http://localhost:3001/api/v1/contacts/import \
  -H <span class="str">"Authorization: Bearer YOUR_API_KEY"</span> \
  -F <span class="str">"file=@customers.csv"</span></pre>

      <h3 class="sub-subsection">Step 3 ‚Äî Create group</h3>
      <pre>curl -X POST http://localhost:3001/api/v1/groups \
  -H <span class="str">"Authorization: Bearer YOUR_API_KEY"</span> \
  -H <span class="str">"Content-Type: application/json"</span> \
  -d <span class="str">'{"name":"All Customers"}'</span>

<span class="comment"># Save the group id from the response!</span></pre>

      <h3 class="sub-subsection">Step 4 ‚Äî Add contacts to group</h3>
      <pre>curl -X POST http://localhost:3001/api/v1/groups/GROUP_ID/contacts \
  -H <span class="str">"Authorization: Bearer YOUR_API_KEY"</span> \
  -H <span class="str">"Content-Type: application/json"</span> \
  -d <span class="str">'{"contactIds":["id1","id2","id3"]}'</span></pre>

      <h3 class="sub-subsection">Step 5 ‚Äî Launch campaign</h3>
      <pre>curl -X POST http://localhost:3001/api/v1/campaigns \
  -H <span class="str">"Authorization: Bearer YOUR_API_KEY"</span> \
  -H <span class="str">"Content-Type: application/json"</span> \
  -d <span class="str">'{"name":"Ramadan Promo","groupId":"GROUP_ID","message":"Reethi Cafe: 20% off all meals this Ramadan. Show this SMS at counter."}'</span>

<span class="comment"># Returns campaign id ‚Äî use it to track progress</span></pre>

      <h3 class="sub-subsection">Step 6 ‚Äî Poll progress</h3>
      <pre>curl http://localhost:3001/api/v1/campaigns/CAMPAIGN_ID/progress \
  -H <span class="str">"Authorization: Bearer YOUR_API_KEY"</span>

<span class="comment"># Poll every 2.5 seconds until status = "COMPLETED"</span></pre>

      <div class="callout callout-success">
        <span class="callout-icon">‚úÖ</span>
        <div class="callout-body">
          <p class="callout-title">Use the API Console for interactive testing</p>
          <p class="callout-text">All these endpoints can be tested interactively using the <a href="../index.html" style="color:var(--brand)">API Console dashboard</a> ‚Äî no curl needed. Just paste your API key and fill in the forms.</p>
        </div>
      </div>

    </div>
  </main>
</div>

<script>
  const links = document.querySelectorAll('.sidebar-link[href^="#"]');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        links.forEach(l => l.classList.remove('active'));
        const a = document.querySelector(`.sidebar-link[href="#${e.target.id}"]`);
        if (a) a.classList.add('active');
      }
    });
  }, { rootMargin: '-20% 0px -70% 0px' });
  document.querySelectorAll('.section-anchor').forEach(s => observer.observe(s));
</script>
</body>
</html>
